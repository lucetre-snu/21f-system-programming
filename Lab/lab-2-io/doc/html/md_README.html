<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>System Programming: Lab 2: I/O</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">System Programming
   &#160;<span id="projectnumber">Fall 2020</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Lab 2: I/O </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this lab, we implement a tool that lists all files in a directory and all its subdirectories.</p>
<p>You will learn</p><ul>
<li>how to retrieve files in a directory</li>
<li>how to retrieve the metadata of a file</li>
<li>how to print nicely formatted output</li>
<li>that exception handling takes a significant effort</li>
<li>that string handling is not one of C's strenghs</li>
<li>and a bunch of other useful programming tricks and C library functions</li>
</ul>
<p>[[<em>TOC</em>]]</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Important Dates</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Date   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Wednesday, September 15, 18:30   </td><td class="markdownTableBodyLeft">I/O Lab hand-out    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Friday, September 24, 16:30   </td><td class="markdownTableBodyLeft">I/O Lab session 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Wednesday, September 29, 18:30   </td><td class="markdownTableBodyLeft">I/O Lab session 2    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Sunday, October 3, 12:00   </td><td class="markdownTableBodyLeft">Submission deadline   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md2"></a>
Logistics</h1>
<h2><a class="anchor" id="autotoc_md3"></a>
Hand-out</h2>
<p>The lab is handed out via <a href="https://teaching.csap.snu.ac.kr/system-programming-fall-2021/lab/lab-2-io">https://teaching.csap.snu.ac.kr/system-programming-fall-2021/lab/lab-2-io</a>.</p>
<p>Start by forking the lab into your namespace, then <b>make sure that the lab's visibility is set to private</b>. Read the instructions here carefully. Finally, clone the lab to your local computer and get to work.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Submission</h2>
<p>Commit and push your work frequently to avoid data loss. Once you are happy with your solution and want to submit it for grading, create a tag called "Submission". <b>The timestamp of the "Submission" tag is considered your submission time</b>.</p>
<p>To create a tag, go to your I/O lab repository on <a href="https://teaching.csap.snu.ac.kr/">https://teaching.csap.snu.ac.kr/</a> and navigate to Repository -&gt; Tags. Enter "Submission" as the Tag name then hit "Create tag". You can leave the other fields empty. <br  />
</p>
<p>If you later discover an error and want to update your submission, you can delete the "Submission" tag, fix your solution, and create a new "Submission" tag. If that happens <em>after</em> the submission deadline, you also need to email the TAs so that they are aware of the update to your submission.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Dirtree Overview</h1>
<p>Our tool is called <em>dirtree</em>. Dirtree recursively traverses a directory tree and prints out a sorted list of all files.</p>
<div class="fragment"><div class="line">$ dirtree demo</div>
<div class="line">demo</div>
<div class="line">  subdir1</div>
<div class="line">    sparsefile</div>
<div class="line">    thisisanextremelylongfilenameforsuchasimplisticfile</div>
<div class="line"> subdir2</div>
<div class="line">    brokenlink</div>
<div class="line">    symboliclink</div>
<div class="line">  subdir3</div>
<div class="line">    pipe</div>
<div class="line">    socket</div>
<div class="line">  one</div>
<div class="line">  two</div>
</div><!-- fragment --><p>Dirtree can also print a fancy directory tree and show details... </p><div class="fragment"><div class="line">$ dirtree -t -v demo</div>
<div class="line">demo</div>
<div class="line">|-subdir1                                                  devel:devel           4096         8  d</div>
<div class="line">| |-sparsefile                                             devel:devel           8192         8   </div>
<div class="line">| `-thisisanextremelylongfilenameforsuchasimplistic...     devel:devel           1000         8   </div>
<div class="line">|-subdir2                                                  devel:devel           4096         8  d</div>
<div class="line">| |-brokenlink                                             devel:devel              8         0  l</div>
<div class="line">| `-symboliclink                                           devel:devel              6         0  l</div>
<div class="line">|-subdir3                                                  devel:devel           4096         8  d</div>
<div class="line">| |-pipe                                                   devel:devel              0         0  f</div>
<div class="line">| `-socket                                                 devel:devel              0         0  s</div>
<div class="line">|-one                                                      devel:devel              1         8   </div>
<div class="line">`-two                                                      devel:devel              2         8   </div>
</div><!-- fragment --><p>...or a summary of a directory: </p><div class="fragment"><div class="line">$ dirtree -v -s demo</div>
<div class="line">Name                                                        User:Group           Size    Blocks Type </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">demo</div>
<div class="line">  subdir1                                                  devel:devel           4096         8  d</div>
<div class="line">    sparsefile                                             devel:devel           8192         8   </div>
<div class="line">    thisisanextremelylongfilenameforsuchasimplistic...     devel:devel           1000         8   </div>
<div class="line">  subdir2                                                  devel:devel           4096         8  d</div>
<div class="line">    brokenlink                                             devel:devel              8         0  l</div>
<div class="line">    symboliclink                                           devel:devel              6         0  l</div>
<div class="line">  subdir3                                                  devel:devel           4096         8  d</div>
<div class="line">    pipe                                                   devel:devel              0         0  f</div>
<div class="line">    socket                                                 devel:devel              0         0  s</div>
<div class="line">  one                                                      devel:devel              1         8   </div>
<div class="line">  two                                                      devel:devel              2         8   </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">4 files, 3 directories, 2 links, 1 pipe, and 1 socket                           21497        56</div>
</div><!-- fragment --><p>Last but not least, dirtree can generate aggregate totals over several directories: </p><div class="fragment"><div class="line">$ dirtree -v -s demo/subdir1 demo/subdir2</div>
<div class="line">Name                                                        User:Group           Size    Blocks Type </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">demo/subdir1</div>
<div class="line">  sparsefile                                               devel:devel           8192         8   </div>
<div class="line">  thisisanextremelylongfilenameforsuchasimplisticfile      devel:devel           1000         8   </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">2 files, 0 directories, 0 links, 0 pipes, and 0 sockets                          9192        16</div>
<div class="line"> </div>
<div class="line">Name                                                        User:Group           Size    Blocks Type </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">demo/subdir2</div>
<div class="line">  brokenlink                                               devel:devel              8         0  l</div>
<div class="line">  symboliclink                                             devel:devel              6         0  l</div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">0 files, 0 directories, 2 links, 0 pipes, and 0 sockets                            14         0</div>
<div class="line"> </div>
<div class="line">Analyzed 2 directories:</div>
<div class="line">  total # of files:                       2</div>
<div class="line">  total # of directories:                 0</div>
<div class="line">  total # of links:                       2</div>
<div class="line">  total # of pipes:                       0</div>
<div class="line">  total # of socksets:                    0</div>
<div class="line">  total file size:                     9206</div>
<div class="line">  total # of blocks:                     16</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md6"></a>
Dirtree Specification</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
Command line arguments</h2>
<p>Dirtree accepts the following command line arguments </p><div class="fragment"><div class="line">dirtree [Options] [Directories]</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">-h   </td><td class="markdownTableBodyLeft">Help screen    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">-t   </td><td class="markdownTableBodyLeft">Turn on fancy tree view    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">-v   </td><td class="markdownTableBodyLeft">Turn on verbose mode    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">-s   </td><td class="markdownTableBodyLeft">Turn on summary mode   </td></tr>
</table>
<p><code>Directories</code> is a list of directories that are to be traversed. Dirtree accepts up to 64 directories. If no directory is given, then the current directory is traversed.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Operation</h2>
<ol type="1">
<li>Dirtree traverses each directory in the list <code>Directories</code> recursively.</li>
<li>In each directory, it enumerates all directory entries and prints them in alphabetical order. Directories are listed before files. The special entries '.' and '..' are ignored.</li>
<li>A summary is printed after each directory. If several directories are traversed, an aggregate total is printed at the end.</li>
</ol>
<h2><a class="anchor" id="autotoc_md9"></a>
Output</h2>
<h3><a class="anchor" id="autotoc_md10"></a>
Simple mode vs. fancy tree view mode</h3>
<p>As dirtree traverses the directory tree, it prints the names of the sorted entities in a directory. The names are indented according to the level of the subdirectory. For each additional level, the names are shifted right two positions to allow for easy visual identification of the directory structure.</p>
<p><b>Simple mode</b> indents names by two spaces for each additional level. <b>Fancy tree mode</b> prints a tree structure using only ASCII characters.</p>
<table class="doxtable">
</table>
<p>Simple mode </p>
<p>Fancy tree view mode  &lt;/thead&gt; &lt;tbody&gt; </p>
<pre>dir             <br  />
  subdir1<br  />
    subdir2<br  />
      file1<br  />
      file2<br  />
      file3<br  />
  file4</pre>  <pre>dir             <br  />
|-subdir1<br  />
| `-subdir2<br  />
|   |-file1<br  />
|   |-file2<br  />
|   `-file3<br  />
`-file4</pre><p>   &lt;/tbody&gt; </p>
<h3><a class="anchor" id="autotoc_md11"></a>
Detailed mode</h3>
<p>In detailed mode, dirtree prints out the following additional details for each entry:</p><ul>
<li>User and group <br  />
 Each file in Unix belongs to a user and a group. Detailed mode prints the names of the user and the group separated by a colon (:).</li>
<li>Size <br  />
 The size of the file in bytes.</li>
<li>Disk blocks <br  />
 The number of blocks this file occupies on the disk.</li>
<li>File type <br  />
 Indicates the type of file by a single character</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Type   </th><th class="markdownTableHeadCenter">Character    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">File   </td><td class="markdownTableBodyCenter">_(empty)_    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Directory   </td><td class="markdownTableBodyCenter">d    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Link   </td><td class="markdownTableBodyCenter">l    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Character device   </td><td class="markdownTableBodyCenter">c    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Block device   </td><td class="markdownTableBodyCenter">b    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Fifo   </td><td class="markdownTableBodyCenter">f    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Socket   </td><td class="markdownTableBodyCenter">s   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md12"></a>
Summary mode</h3>
<p>In summary mode, dirtree prints a header and footer around each directory and a one-liner containing statistics about the directory.</p>
<p>If there are more than one directories provided on the command line, an aggregate total of all listed directories is shown. </p><div class="fragment"><div class="line">$ dirtree -s demo/subdir1 demo/subdir3</div>
<div class="line"> </div>
<div class="line">Name</div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">demo/subdir1</div>
<div class="line">  subdir2</div>
<div class="line">    file1</div>
<div class="line">    link</div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">1 file, 1 directory, 1 link, 0 pipes, and 0 sockets</div>
<div class="line"> </div>
<div class="line">Name</div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">demo/subdir3</div>
<div class="line">  file2</div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">1 file, 0 directories, 0 links, 0 pipes, and 0 sockets</div>
<div class="line"> </div>
<div class="line">Analyzed 2 directories:</div>
<div class="line">  total # of files:                       2</div>
<div class="line">  total # of directories:                 1</div>
<div class="line">  total # of links:                       1</div>
<div class="line">  total # of pipes:                       0</div>
<div class="line">  total # of socksets:                    0</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md13"></a>
Output formatting</h3>
<p>The output in simple mode prints all elements with the correct indentation. In detailed mode, the output is nicely formatted and filenames that are too long are cut and end with three dots (...). Unless explicitly specified, you can decide for yourself whether and how you are formatting exceptional cases (error messages, etc.)</p>
<div class="fragment"><div class="line">$ dirtree -v -s demo2</div>
<div class="line">Name                                                        User:Group           Size    Blocks Type </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">demo2</div>
<div class="line">  subdir1                                                  devel:devel           4096         8  d</div>
<div class="line">    subdir2                                                devel:devel           4096         8  d</div>
<div class="line">      fifo                                                 devel:devel              0         0  f</div>
<div class="line">      link                                                 devel:devel             11         0  l</div>
<div class="line">      socket                                               devel:devel              0         0  s</div>
<div class="line">      unreasonablyextremelylongfilenamethatdoesntfi...     devel:devel              0         0</div>
<div class="line">  file4                                                    devel:devel              0         0</div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">2 files, 2 directories, 1 link, 1 pipe, and 1 socket                             8203        16</div>
</div><!-- fragment --><p>The output in detailed mode consists of the following elements:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Output element   </th><th class="markdownTableHeadCenter">Width   </th><th class="markdownTableHeadCenter">Alignment   </th><th class="markdownTableHeadLeft">Action on overflow    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Path and name   </td><td class="markdownTableBodyCenter">54   </td><td class="markdownTableBodyCenter">left   </td><td class="markdownTableBodyLeft">cut and end with three dots    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">User name   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter">right   </td><td class="markdownTableBodyLeft">ignore    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Group name   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter">left   </td><td class="markdownTableBodyLeft">ignore    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">File size   </td><td class="markdownTableBodyCenter">10   </td><td class="markdownTableBodyCenter">right   </td><td class="markdownTableBodyLeft">ignore    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Disk blocks   </td><td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter">right   </td><td class="markdownTableBodyLeft">ignore    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Type   </td><td class="markdownTableBodyCenter">1   </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyLeft"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Summary line   </td><td class="markdownTableBodyCenter">68   </td><td class="markdownTableBodyCenter">left   </td><td class="markdownTableBodyLeft">limit to 68 characters    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Total size   </td><td class="markdownTableBodyCenter">14   </td><td class="markdownTableBodyCenter">right   </td><td class="markdownTableBodyLeft">ignore    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Total blocks   </td><td class="markdownTableBodyCenter">9   </td><td class="markdownTableBodyCenter">right   </td><td class="markdownTableBodyLeft">ignore   </td></tr>
</table>
<p>The following rendering shows the output formatting in detail for each of the different elements. The two rows on top indicate the character position on a line. </p><div class="fragment"><div class="line">         1         2         3         4         5         6         7         8         9        10</div>
<div class="line">1........0.........0.........0.........0.........0.........0.........0.........0.........0.........0</div>
<div class="line"> </div>
<div class="line">Name                                                        User:Group           Size    Blocks Type </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">&lt;path and name                                       &gt;  &lt;  user&gt;:&lt;group &gt;  &lt;    size&gt;  &lt;blocks&gt;  t</div>
<div class="line">&lt;path and name                                       &gt;  &lt;  user&gt;:&lt;group &gt;  &lt;    size&gt;  &lt;blocks&gt;  t</div>
<div class="line">...</div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">&lt;summary                                                           &gt;   &lt;  total size&gt; &lt;totblks&gt;</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md14"></a>
Summary line</h4>
<p>dirtree takes great care to output grammatically correct English. Zero or &gt;=2 elements are output in plural form, while for exactly one element the singular form is used. Compare the two summary lines: </p><div class="fragment"><div class="line">0 files, 2 directories, 1 link, 1 pipe, and 1 socket</div>
<div class="line"> </div>
<div class="line">1 file, 1 directory, 2 links, 0 pipes, and 5 sockets</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Error handling</h2>
<p>Errors that occur when processing a directory (permission errors) are reported in place of the entries of that directory: </p><div class="fragment"><div class="line">$ dirtree -v /etc/cups</div>
<div class="line">/etc/cups</div>
<div class="line">  ...</div>
<div class="line">  interfaces                                                root:lp              4096         8  d</div>
<div class="line">    ERROR: Cannot allocate memory</div>
<div class="line">  ppd                                                       root:lp              4096         8  d</div>
<div class="line">    .keep_net-print_cups-0                                  root:root               0         0   </div>
<div class="line">  ssl                                                       root:lp              4096         8  d</div>
<div class="line">     ERROR: Permission denied</div>
<div class="line">  client.conf                                               root:root              31         8   </div>
<div class="line">  ...</div>
</div><!-- fragment --><p>If an error occurs when retrieving the meta data of a file, the error message is printed inplace of the file's meta data: </p><div class="fragment"><div class="line">$ dirtree -v /proc/self/fd</div>
<div class="line">/proc/self/fd</div>
<div class="line">  0                                                        devel:devel             64         0  l</div>
<div class="line">  1                                                        devel:devel             64         0  l</div>
<div class="line">  2                                                        devel:devel             64         0  l</div>
<div class="line">  3                                                     No such file or directory</div>
</div><!-- fragment --><p>For any other errors, you can choose what to do. The reference implementation aborts on most errors: </p><div class="fragment"><div class="line">$ dirtree -s -v demo</div>
<div class="line">Name                                                        User:Group           Size    Blocks Type </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">demo</div>
<div class="line">  subdir1                                               bernhard:users           4096         8  d</div>
<div class="line">    sparsefile                                          bernhard:users           8192         8   </div>
<div class="line">Out of memory.</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
Handout Overview</h1>
<p>The handout contains the following files and directories</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">File/Directory   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="README_8md.html">README.md</a>   </td><td class="markdownTableBodyLeft">this file    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Makefile   </td><td class="markdownTableBodyLeft">Makefile driver program    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="dirtree_8c.html" title="resursively traverse directory tree and list all entries">dirtree.c</a>   </td><td class="markdownTableBodyLeft">Skeleton for <a class="el" href="dirtree_8c.html" title="resursively traverse directory tree and list all entries">dirtree.c</a>. Implement your solution by editing this file.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">.gitignore   </td><td class="markdownTableBodyLeft">Tells git which files to ignore    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">doc/   </td><td class="markdownTableBodyLeft">Doxygen instructions, configuration file, and auto-generated documentation    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">reference/   </td><td class="markdownTableBodyLeft">Reference implementation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">tools/   </td><td class="markdownTableBodyLeft">Tools to generate directory trees for testing   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md17"></a>
Reference implementation</h2>
<p>The directory <code>reference</code> contains our reference implementation. You can use it to compare your output to ours.</p>
<h2><a class="anchor" id="autotoc_md18"></a>
Tools</h2>
<p>The <code>tools</code> directory contains tools to generate test directory trees to test your solution.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">File/Directory   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">gentree.sh   </td><td class="markdownTableBodyLeft">Driver script to generate a test directory tree.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">mksock   </td><td class="markdownTableBodyLeft">Helper program to generate a Unix socket.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">*.tree   </td><td class="markdownTableBodyLeft">Script files describing the directory tree layout.   </td></tr>
</table>
<p>Invoke <code>gentree.sh</code> with a script file to generate one of the provided test directory trees.</p>
<p><b>Note:</b> due to limitations of VirtualBox's shared folder implementation and your host OS, not all file types are supported in the shared folder. We recommand to create the test directories natively inside the VM, for example, in the <code>work/</code> directory.</p>
<p>Assuming you are located in the root directory of your I/O lab repository, use the follwing command to generate the <code>demo</code> directory tree </p><div class="fragment"><div class="line">$ ls</div>
<div class="line">dirtree.c  doc  Makefile  README.md  reference  tools</div>
<div class="line">$ tools/gentree.sh tools/demo.tree </div>
<div class="line">Generating tree from &#39;tools/demo.tree&#39;...</div>
<div class="line">Done. Generated 4 files, 2 links, 1 fifos, and 1 sockets. 0 errors reported.</div>
</div><!-- fragment --><p>You can list the contents of the tree with the reference implementation: </p><div class="fragment"><div class="line">$ reference/dirtree -t -v -s demo/</div>
<div class="line">Name                                                        User:Group           Size    Blocks Type </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">demo/</div>
<div class="line">|-subdir1                                                  devel:devel           4096         8  d</div>
<div class="line">| |-sparsefile                                             devel:devel           8192         8   </div>
<div class="line">| `-thisisanextremelylongfilenameforsuchasimplistic...     devel:devel           1000         8   </div>
<div class="line">|-subdir2                                                  devel:devel           4096         8  d</div>
<div class="line">| |-brokenlink                                             devel:devel              8         0  l</div>
<div class="line">| `-symboliclink                                           devel:devel              6         0  l</div>
<div class="line">|-subdir3                                                  devel:devel           4096         8  d</div>
<div class="line">| |-pipe                                                   devel:devel              0         0  f</div>
<div class="line">| `-socket                                                 devel:devel              0         0  s</div>
<div class="line">|-one                                                      devel:devel              1         8   </div>
<div class="line">`-two                                                      devel:devel              2         8   </div>
<div class="line">----------------------------------------------------------------------------------------------------</div>
<div class="line">4 files, 3 directories, 2 links, 1 pipe, and 1 socket                           21497        56</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md19"></a>
Your Task</h1>
<p>Your task is to implement dirtree according to the specification above.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Design</h2>
<p>In a first step, write down the logical steps of your program on a sheet of paper. We will do that together during the first lab session.</p>
<p><b>Recommendation</b>: do not look at the provided code in <code><a class="el" href="dirtree_8c.html" title="resursively traverse directory tree and list all entries">dirtree.c</a></code> yet! Think about the logical steps yourself. The design is the most difficult and important phase in any project - and also the phase that requires the most practice and sets apart hobby programmers from experts.</p>
<h2><a class="anchor" id="autotoc_md21"></a>
Implementation</h2>
<p>Once you have designed the outline of your implementation, you can start implementing it. We provide a skeleton file to help you get started.</p>
<p>The skeleton provides data structures to manage the statistics of a directory, a function to read the next entry from a directory while ignoring the '.' and '..' entries, a comparator function to sort the entries of a directory using quicksort, and full argument parsing and syntax helpers.</p>
<p>You have to implement the following two parts:</p><ol type="1">
<li>in <code><a class="el" href="dirtree_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="program entry point">main()</a></code> <br  />
 Iterate through the list of directories stored in <code>directories</code>. For each directory, call <code><a class="el" href="dirtree_8c.html#aa25c65a19757e988d11a49a0ae26bd77" title="recursively process directory dn and print its tree">processDir()</a></code> with the appropriate parameters. Also, depending on the output mode, print header, footer, and statistics.</li>
<li>in <code><a class="el" href="dirtree_8c.html#aa25c65a19757e988d11a49a0ae26bd77" title="recursively process directory dn and print its tree">processDir()</a></code> <br  />
 Open, enumerate, sort, and close the directory. Print elements one by one. Update statistics. If the element is a directory, call <code><a class="el" href="dirtree_8c.html#aa25c65a19757e988d11a49a0ae26bd77" title="recursively process directory dn and print its tree">processDir()</a></code> recursively.</li>
</ol>
<h2><a class="anchor" id="autotoc_md22"></a>
Hints</h2>
<h3><a class="anchor" id="autotoc_md23"></a>
Skeleton code</h3>
<p>The skeleton code is meant to help you get started. You can modify it in any way you see fit - or implement this lab completely from scratch.</p>
<h3><a class="anchor" id="autotoc_md24"></a>
C library calls</h3>
<p>Knowing which library functions exist and how to use them is difficult at the beginning in every programming language. To help you get started, we provide a list of C library calls / system calls grouped by topic that you may find helpful to solve this lab. Read the man pages carefully to learn how exactly the functions operate.</p>
<table class="doxtable">
</table>
<p>Topic </p>
<p>C library call </p>
<p>Description  &lt;/thead&gt; &lt;tbody&gt; </p>
<p>String operations  </p>
<p><code>strcmp()</code>  </p>
<p>compare two strings   </p>
<p><code>strncpy()</code>  </p>
<p>copy up to n characters of one string into another   </p>
<p><code>strdup()</code>  </p>
<p>create a copy of a string. Use <code>free()</code> to free it after use   </p>
<p><code>asprintf()</code>  </p>
<p>asprintf() is extremely helpful to print into a string and allocate memory for it at the same time. We will show some examples during the lab session.   </p>
<p>Directory management  </p>
<p><code>opendir()</code>  </p>
<p>open a directory to enumerate its entries   </p>
<p><code>closedir()</code>  </p>
<p>close an open directory   </p>
<p><code>readdir()</code>  </p>
<p>read next entry from directory   </p>
<p>File meta data  </p>
<p><code>stat()</code>  </p>
<p>retrieve meta data of a file, follow links   </p>
<p><code>lstat()</code>  </p>
<p>retrieve meta data of a file, do not follow links   </p>
<p>User/group information  </p>
<p><code>getpwuid()</code>  </p>
<p>retrieve user information (including their name) for a given user ID   </p>
<p><code>getgrgid()</code>  </p>
<p>retrieve group information (including its name) for a given group ID   </p>
<p>Sorting  </p>
<p><code>qsort()</code>  </p>
<p>quick-sort an array   &lt;/tbody&gt; </p>
<h3><a class="anchor" id="autotoc_md25"></a>
Final words</h3>
<p>This may well be your first project interacting with the C standard library and system calls. At the beginning, you may feel overwhelmed and have no idea how to approach this task.</p>
<p>Do not despair - we will give detailed instructions during the lab sessions and provide individual help so that each of you can finish this lab. After completing this lab, you can call yourself a system programmer. Inexperienced still, but anyway a system programmer.</p>
<div align="center" style="font-size: 1.75em;"></div><div align="center" style="font-size: 1.75em;"><b>Happy coding!</b> </div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
